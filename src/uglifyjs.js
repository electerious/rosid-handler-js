'use strict'

const uglifyjs = require('uglify-js')

/**
 * Compress JS using UglifyJS.
 * @public
 * @param {?String} str - JS.
 * @param {?Object} opts - Options for the task.
 * @returns {Promise} Returns the following properties if resolved: {String}.
 */
module.exports = function(str, opts) {

	return new Promise((resolve, reject) => {

		// Do nothing when called with an empty string
		if (str==null || str==='') return resolve('')

		// Skip task when output should not be optimized
		if (opts!=null && opts.optimize===false) return resolve(str)

		// Reduce size of JS
		const result = uglifyjs.minify(str)

		resolve(result.code)

	})

}